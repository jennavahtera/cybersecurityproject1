# Cyber Security Base: Project I

The project is implemented with Django and Python. The initial base for the project was done with the help of the Django tutorial that was linked in the course material. I did the base for the Poll app, but added users so that they can register accounts, log in, log out and only make polls and vote on them if they are logged in. 

## User instructions

- Download repository
- Create environment with `python -m venv polls_env`
- Activate environment with `source polls_env/bin/activate`
- Install requirements with `pip install -r requirements.txt`
- Move to the project folder and run `python manage.py migrate`
- After migration is done start project with `python manage.py runserver`
- Navigate to localhost:3000 in browser and start using software

## FLAW 1: OWASP A01:2021 – Broken Access Control
The flaw can be found at users/views.py (https://github.com/jennavahtera/cybersecurityproject1/blob/main/project/users/views.py) starting at line 37 until line 56. The login view generates a message to the person trying to login and the message shows too much information to the unauthorised user. This is an example of one of the mapped CWEs in Broken Access Control, the CWE-200: Exposure of Sensitive Information to an Unauthorized Actor. If there doesn’t exist such username that the person is trying for, the message is “Invalid username.”. If there exists the specific username, but the password is not correct for that user, the message is “Invalid password.” The problem is fixed if lines 41-56 are deleted and lines 58-73 are commented out. In the fix, Django’s own form validation is used (line 59) and also the error messages (lines 68 & 73) don’t specify whether the username or the password is incorrect. 

## FLAW 2: OWASP A02:2021 – Cryptographic Failures
The flaw can be found at settings.py at line 27 (https://github.com/jennavahtera/cybersecurityproject1/blob/main/project/polls/settings.py). This flaw relates to the CWE-321 or Use of hard-coded cryptographic key. The settings.py file has the Django cryptographic key as a hard-coded variable when it should not be visible when viewing the source code of the software. The secret key is very important to be kept hidden, because it is used in securing signed data. This helps create unique tokens for user sessions, password reset requests and generating unique hash functions. This security issue can be fixed by commenting out lines 15-17 and line 28 in settings.py. This enables the use of python dotenv which is used to create an environment file containing sensitive information. The result of this is that the sensitive information can be shared to those who require it and remove it from the available source code. For this project the .env file is included in the source code in order to demonstrate its contents. 

## FLAW 3: OWASP A05:2021 – Security Misconfiguration (and also A04:2021 – Insecure Design)
This flaw can be found at settings.py (https://github.com/jennavahtera/cybersecurityproject1/blob/main/project/mysite/settings.py) at line 30. When the DEBUG setting is left to True, it leaves the app in a vulnerable state. It should be set to True only in the development phase, never in production. This is at it’s core a Security Misconfiguration concern, but I noticed that this can lead to other security flaws in other OWASP categories as well. I also have a flaw that the homepage of the polls app isn’t included in the urls.py (https://github.com/jennavahtera/cybersecurityproject1/blob/main/project/mysite/urls.py) line 26. When the DEBUG is set to true and the user tries to go to that address, it shows an error message 404 that shows the whole url composition of the site. This is an example of one of the mapped CWEs of OWASP A04:2021 - Insecure Design, specifically CWE-209 Generation of Error Message Containing Sensitive Information. This can be fixed mainly by changing the DEBUG to False (at settings.py, the line 30 should be commented and 31 commented out). Then the homepage should be included in urls (commenting out line 26 in urls.py).

## FLAW 4: OWASP A07:2021 – Identification and Authentication Failures
This flaw can be found at settings.py (https://github.com/jennavahtera/cybersecurityproject1/blob/main/project/mysite/settings.py) starting at line 96 until line 116 (most lines are comments). In this project, the passwords aren’t validated at all. They can be however long, have whatever characters, like only numbers for example. The passwords can also be the same as the username or they can be common and too vulnerable passwords, like “admin” for example. This is an example of one of the mapped CWEs in Identification and Authentication Failures, the CWE-521 Weak Password Requirements. This can be fixed with commenting out the lines 104-115, since Django already offers these tools for password validation.

## FLAW 5: OWASP A09:2021 – Security Logging and Monitoring Failures
This flaw can be found at users/views.py (https://github.com/jennavahtera/cybersecurityproject1/blob/main/project/users/views.py). The flaw is basically the whole page since it is that there isn’t logging at all, which is an example of one the mapped CWEs in Security Logging and Monitoring Failures, the CWE-778 Insufficient Logging. This can be fixed by adding some kind of logging. The fixes are commented out. First, the loggers are imported and added (lines 12-13). The fixes to this problem are included in the commented fix to flaw 1, but they aren’t needed to fix flaw 1. I just wanted to add them to the code where flaw 1 is also already fixed. Logging information can be gotten by commenting out lines 69 and 72. This logs messages whenever someone tries to login with wrong credentials. Furthermore, it gives the username of the user that is trying to log in. I think more logging could always be added, but I think in my app for now, the most important things to log are people trying to get in with more credentials, and to see the username of the account that someone tries to get in. 
